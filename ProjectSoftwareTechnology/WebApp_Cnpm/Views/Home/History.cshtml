@using Application.DTOs;
@{
    ViewBag.Title = "History";
    Layout = "~/Views/Shared/_Layout.cshtml";

    IEnumerable<ProductDTO> list_Product = ViewData["product"] as IEnumerable<ProductDTO>;
    IEnumerable<InfoOrderDTO> list_InfoOrder = ViewData["infoOrder"] as IEnumerable<InfoOrderDTO>;
    IEnumerable<PayOrderDTO> list_PayOrder = ViewData["payOrder"] as IEnumerable<PayOrderDTO>;
    var UID = ViewData["UID"] as String;
}

<!--Breadcrumb Section Begin-->
<section class="breadcrumb-section set-bg" data-setbg="/img/banner_title.gif" style="background-position:center;background-size:cover;">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center">
                <div class="breadcrumb__text">
                    <h2>Vatva Shop</h2>
                    <div class="breadcrumb__option">
                        <a asp-controller="Home" asp-action="Index">Home</a>
                        <span>History</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!--Breadcrumb Section End-->
<!-- Shoping Cart Section Begin -->
<section class="shoping-cart spad">
    <div class="container" style="margin-top:-130px;">
        <div class="row">
            <div class="col-lg-12">
                <div class="product__details__tab">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#tabs-1" role="tab"
                               aria-selected="true">Waiting for progressing</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-2" role="tab"
                               aria-selected="false">To ship</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-3" role="tab"
                               aria-selected="false">To pay</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-4" role="tab"
                               aria-selected="false">Delivered</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-5" role="tab"
                               aria-selected="false">To cancel</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="tabs-1" role="tabpanel">
                            @{
                                foreach (PayOrderDTO itemPayOrders in list_PayOrder)
                                {
                                    // kiểm tra đơn hàng thuộc tài khoản đang đăng nhập và trong trạng thái chờ xử lý
                                    if (itemPayOrders.UID == UID && itemPayOrders.Status == "Chờ xử lý")
                                    {
                                        // đếm số lượng các loại sản phẩm được đặt mua dựa trên khóa ngoại của idpay
                                        int countIDPayinInforOrder = list_InfoOrder.Where(c => c.IDP == itemPayOrders.ID).Count();
                                        if (countIDPayinInforOrder == 1)
                                        {
                                            foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                            {
                                                // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                {
                                                    // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                    ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                    <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                        <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemInfoOrder.IDP ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Unpaid</span></h5>
                                                        <h6 style="color:#666666;font-weight:500;">Place on @itemPayOrders.DateOrder</h6>
                                                        <div style="margin-top:-20px;">
                                                            <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                            <div style="width:580px;float:right;">
                                                                <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;">Waiting for progressing</span></h3>
                                                                <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">1 items, Total: </span><span style="color:red;">@int.Parse(itemInfoOrder.IntoMoney).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                                <a href="javascript: ToCancel(@itemPayOrders.ID)" style="margin-top: -15px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">To Cancel</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                        }
                                        else
                                        {
                                            <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemPayOrders.ID ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Unpaid</span></h5>
                                                <h6 style="color:#666666;font-weight:500;margin-bottom:-40px;">Place on @itemPayOrders.DateOrder</h6>
                                                @{
                                                    foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                                    {
                                                        // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                        if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                        {
                                                            // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                            ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                            <div class="product__details__tab__desc" style="margin-top:-30px;">
                                                                <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                                <div style="width:580px;float:right;">
                                                                    <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;">Waiting for progressing</span></h3>
                                                                    <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                    <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                }
                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">@countIDPayinInforOrder items, Total: </span><span style="color:red;">@int.Parse(itemPayOrders.Total).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                <a href="javascript: ToCancel(@itemPayOrders.ID)" style="margin-top: -12px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">To Cancel</a>
                                            </div>
                                        }
                                    }
                                }
                            }
                        </div>
                        <div class="tab-pane" id="tabs-2" role="tabpanel">
                            @{
                                foreach (PayOrderDTO itemPayOrders in list_PayOrder)
                                {
                                    // kiểm tra đơn hàng thuộc tài khoản đang đăng nhập và trong trạng thái chờ xử lý
                                    if (itemPayOrders.UID == UID && itemPayOrders.Status == "Chờ giao hàng")
                                    {
                                        // đếm số lượng các loại sản phẩm được đặt mua dựa trên khóa ngoại của idpay
                                        int countIDPayinInforOrder = list_InfoOrder.Where(c => c.IDP == itemPayOrders.ID).Count();
                                        if (countIDPayinInforOrder == 1)
                                        {
                                            foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                            {
                                                // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                {
                                                    // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                    ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                    <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                        <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemInfoOrder.IDP ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Unpaid</span></h5>
                                                        <h6 style="color:#666666;font-weight:500;">Place on @itemPayOrders.DateOrder</h6>
                                                        <div style="margin-top:-20px;">
                                                            <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                            <div style="width:580px;float:right;">
                                                                <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;">To Ship</span></h3>
                                                                <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">1 items, Total: </span><span style="color:red;">@int.Parse(itemInfoOrder.IntoMoney).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                                <a href="javascript: ToContact()" style="margin-top: -15px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">To Contact</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                        }
                                        else
                                        {
                                            <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemPayOrders.ID ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Unpaid</span></h5>
                                                <h6 style="color:#666666;font-weight:500;margin-bottom:-40px;">Place on @itemPayOrders.DateOrder</h6>
                                                @{
                                                    foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                                    {
                                                        // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                        if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                        {
                                                            // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                            ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                            <div class="product__details__tab__desc" style="margin-top:-30px;">
                                                                <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                                <div style="width:580px;float:right;">
                                                                    <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;">To Ship</span></h3>
                                                                    <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                    <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                }
                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">@countIDPayinInforOrder items, Total: </span><span style="color:red;">@int.Parse(itemPayOrders.Total).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                <a href="javascript: ToContact()" style="margin-top: -12px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">To Contact</a>
                                            </div>
                                        }
                                    }
                                }
                            }
                        </div>
                        <div class="tab-pane" id="tabs-3" role="tabpanel">
                            @{
                                foreach (PayOrderDTO itemPayOrders in list_PayOrder)
                                {
                                    // kiểm tra đơn hàng thuộc tài khoản đang đăng nhập và trong trạng thái chờ xử lý
                                    if (itemPayOrders.UID == UID && itemPayOrders.Status == "Chờ thanh toán")
                                    {
                                        // đếm số lượng các loại sản phẩm được đặt mua dựa trên khóa ngoại của idpay
                                        int countIDPayinInforOrder = list_InfoOrder.Where(c => c.IDP == itemPayOrders.ID).Count();
                                        if (countIDPayinInforOrder == 1)
                                        {
                                            foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                            {
                                                // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                {
                                                    // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                    ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                    <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                        <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemInfoOrder.IDP ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Unpaid</span></h5>
                                                        <h6 style="color:#666666;font-weight:500;">Place on @itemPayOrders.DateOrder</h6>
                                                        <div style="margin-top:-20px;">
                                                            <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                            <div style="width:580px;float:right;">
                                                                <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;">To Pay</span></h3>
                                                                <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">1 items, Total: </span><span style="color:red;">@int.Parse(itemInfoOrder.IntoMoney).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                                <a href="javascript: ToContact()" style="margin-top: -15px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">To Contact</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                        }
                                        else
                                        {
                                            <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemPayOrders.ID ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Unpaid</span></h5>
                                                <h6 style="color:#666666;font-weight:500;margin-bottom:-40px;">Place on @itemPayOrders.DateOrder</h6>
                                                @{
                                                    foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                                    {
                                                        // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                        if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                        {
                                                            // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                            ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                            <div class="product__details__tab__desc" style="margin-top:-30px;">
                                                                <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                                <div style="width:580px;float:right;">
                                                                    <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;">To Pay</span></h3>
                                                                    <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                    <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                }
                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">@countIDPayinInforOrder items, Total: </span><span style="color:red;">@int.Parse(itemPayOrders.Total).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                <a href="javascript: ToContact()" style="margin-top: -12px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">To Contact</a>
                                            </div>
                                        }
                                    }
                                }
                            }
                        </div>
                        <div class="tab-pane" id="tabs-4" role="tabpanel">
                            @{
                                foreach (PayOrderDTO itemPayOrders in list_PayOrder)
                                {
                                    // kiểm tra đơn hàng thuộc tài khoản đang đăng nhập và trong trạng thái chờ xử lý
                                    if (itemPayOrders.UID == UID && itemPayOrders.Status == "Đã giao hàng")
                                    {
                                        // đếm số lượng các loại sản phẩm được đặt mua dựa trên khóa ngoại của idpay
                                        int countIDPayinInforOrder = list_InfoOrder.Where(c => c.IDP == itemPayOrders.ID).Count();
                                        if (countIDPayinInforOrder == 1)
                                        {
                                            foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                            {
                                                // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                {
                                                    // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                    ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                    <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                        <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemInfoOrder.IDP ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Paid</span></h5>
                                                        <h6 style="color:#666666;font-weight:500;">Place on @itemPayOrders.DateOrder</h6>
                                                        <div style="margin-top:-20px;">
                                                            <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                            <div style="width:580px;float:right;">
                                                                <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;">Delivered</span></h3>
                                                                <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">1 items, Total: </span><span style="color:red;">@int.Parse(itemInfoOrder.IntoMoney).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                                <a href="javascript: ToReview()" style="margin-top: -15px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">To Review</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                        }
                                        else
                                        {
                                            <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemPayOrders.ID ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Paid</span></h5>
                                                <h6 style="color:#666666;font-weight:500;margin-bottom:-40px;">Place on @itemPayOrders.DateOrder</h6>
                                                @{
                                                    foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                                    {
                                                        // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                        if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                        {
                                                            // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                            ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                            <div class="product__details__tab__desc" style="margin-top:-30px;">
                                                                <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                                <div style="width:580px;float:right;">
                                                                    <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;">Delivered</span></h3>
                                                                    <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                    <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                }
                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">@countIDPayinInforOrder items, Total: </span><span style="color:red;">@int.Parse(itemPayOrders.Total).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                <a href="javascript: ToReview()" style="margin-top: -12px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">To Review</a>
                                            </div>
                                        }
                                    }
                                }
                            }
                        </div>
                        <div class="tab-pane" id="tabs-5" role="tabpanel">
                            @{
                                foreach (PayOrderDTO itemPayOrders in list_PayOrder)
                                {
                                    // kiểm tra đơn hàng thuộc tài khoản đang đăng nhập và trong trạng thái chờ xử lý
                                    if (itemPayOrders.UID == UID && itemPayOrders.Status == "Đã hủy")
                                    {
                                        // đếm số lượng các loại sản phẩm được đặt mua dựa trên khóa ngoại của idpay
                                        int countIDPayinInforOrder = list_InfoOrder.Where(c => c.IDP == itemPayOrders.ID).Count();
                                        if (countIDPayinInforOrder == 1)
                                        {
                                            foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                            {
                                                // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                {
                                                    // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                    ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                    <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                        <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id = "@itemPayOrders.ID" style="color:black;"> @itemInfoOrder.IDP ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Unpaid</span></h5>
                                                        <h6 style="color:#666666;font-weight:500;">Place on @itemPayOrders.DateOrder</h6>
                                                        <div style="margin-top:-20px;">
                                                            <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                            <div style="width:580px;float:right;">
                                                                <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;color:red;">Cancelled</span></h3>
                                                                <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">1 items, Total: </span><span style="color:red;">@int.Parse(itemInfoOrder.IntoMoney).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                                <a href="javascript: ToBuyAgain()" style="margin-top: -15px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">Buy again</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                        }
                                        else
                                        {
                                            <div class="product__details__tab__desc" style="width:750px;margin:auto;border:0.5px solid #EEEEEE;margin-top:30px;padding:5px;border-radius:10px;">
                                                <h5>Order<a asp-controller="Home" asp-action="DetailOrder" asp-route-id="@itemPayOrders.ID" style="color:black;"> @itemPayOrders.ID ></a><span style="float: right; font-size: 15px; font-style: italic;color:#666666;">Unpaid</span></h5>
                                                <h6 style="color:#666666;font-weight:500;margin-bottom:-40px;">Place on @itemPayOrders.DateOrder</h6>
                                                @{
                                                    foreach (InfoOrderDTO itemInfoOrder in list_InfoOrder)
                                                    {
                                                        // lấy ra Chi tiết đơn hàng dựa vào IDPay
                                                        if (itemInfoOrder.IDP == itemPayOrders.ID)
                                                        {
                                                            // lấy ra thông tin sản phẩm có trong đơn dựa vào IDSP
                                                            ProductDTO product = list_Product.Where(p => p.IDSP == itemInfoOrder.IDSP).FirstOrDefault();

                                                            <div class="product__details__tab__desc" style="margin-top:-30px;">
                                                                <img src="~/img/product/@product.Image" style="width:150px;height:150px;">
                                                                <div style="width:580px;float:right;">
                                                                    <h3>@product.Name<span style="float:right;font-size:15px;font-style:italic;color:red;">Cancelled</span></h3>
                                                                    <h5 style="font-weight:700;margin-top:10px;">@int.Parse(itemInfoOrder.Price).ToString("#,##0").Replace(",", ".") VNĐ</h5>
                                                                    <h6 style="font-weight:600;margin-top: 10px;color:#666666;">Size: @itemInfoOrder.Size &ensp; x @itemInfoOrder.Amount</h6>
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                }
                                                <h6 style="float:right;margin-top:-45px;"><span style="font-weight: 600;color: #666666;width:400px;">@countIDPayinInforOrder items, Total: </span><span style="color:red;">@int.Parse(itemPayOrders.Total).ToString("#,##0").Replace(",", ".") VNĐ</span></h6>
                                                <a href="javascript: ToBuyAgain()" style="margin-top: -12px;float: right; width: 95px; background-color: orangered; color: white; text-align: center; padding: 3px; font-size: 18px;border-radius:2px;">Buy again</a>
                                            </div>
                                        }
                                    }
                                }
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section History{
    <script>

        function ToCancel(id) {
            if (confirm("Do you want to cancel your orders.?")) {
                $.ajax({
                    url: "/Home/ToCancel",
                    type: "POST",
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        "IDPAYCANCEL": id
                    }),
                    async: true,
                    processData: false,
                    cache: false,
                    success: function (value) {
                        alert(value);
                        location.reload();
                    },
                    error: function () {
                        alert("Cancel your orders failt.!!!");
                    }
                });
            }
        }
        function ToContact() { alert("Thanks for used this function.\nThe system is under construction."); }
        function ToReview() { alert("Thanks for used this function.\nThe system is under construction."); }
        function ToBuyAgain() { alert("Thanks for used this function.\nThe system is under construction."); }

        var body = $("html, body");
        body.animate({ scrollTop: 687 });
    </script>
}
